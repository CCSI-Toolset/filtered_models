!===============================================================================
! Preamble
!===============================================================================
! Author:      William Lane
! Date:        March 25, 2015
! Updated:     
! Description:


!===============================================================================
! Run-Control
!===============================================================================
  RUN_NAME        = 'TEST'
  DESCRIPTION     = 'TEST CASE'
  RUN_TYPE        = 'NEW'
  UNITS           = 'SI'
  
  TIME            =  0.0
  TSTOP           =  10.0
  DT              =  2.0E-5
  DT_MAX          =  1.0E-3
  DT_MIN          =  1.0E-8
  
  ENERGY_EQ       = .TRUE.
  SPECIES_EQ      = .FALSE. .FALSE.
  BLENDING_STRESS = .TRUE.
  DRAG_TYPE       = 'WEN_YU'


!===============================================================================
! Physical Parameters
!===============================================================================
  C_e     =  0.9   ! [-]
  Phi     =  28.0  ! [deg]
  GRAVITY =  9.81  ! [m/s^2]


!===============================================================================
! Numerical Parameters
!===============================================================================
  MAX_NIT           =  50
  NORM_g            =  0.0
  NORM_s            =  0.0
  TOL_RESID         =  0.0001
  MAX_INLET_VEL_FAC =  1.0E32
  DEF_COR           = .TRUE.
  DISCRETIZE        =  9*7


!===============================================================================
! Geometry
!===============================================================================
  COORDINATES = 'CARTESIAN' 
  XLENGTH     =  0.03
  IMAX        =  30
  YLENGTH     =  0.03
  JMAX        =  30
  NO_K        = .TRUE.

  CYCLIC_X    = .TRUE.
  CYCLIC_Y_PD = .TRUE.
  DELP_Y      = @(1.20*133.21*9.807*0.03)


!===============================================================================
! Gas Phase
!===============================================================================
  RO_g0  =  1.3      ! [kg/m^3]
  MU_g0  =  18.0E-6  ! [kg/m.s]
  K_g0   =  0.024    ! [W/m.K]
  C_pg0  =  1150.0   ! [J/kg.K]


!===============================================================================
! Solid Phase
!===============================================================================
  MMAX      =  2

  NMAX_s(1) =  1
  D_p0(1)   =  200.0E-6  ! [m]
  RO_s0(1)  =  441.0     ! [kg/m^3]
  K_s0(1)   =  0.2       ! [W/m.K]
  C_ps0(1)  =  2000.0    ! [J/kg.K]
  EP_star   =  0.36      ! [-]

  NMAX_s(2) =  1
  RO_s0(2)  =  1.0
  D_p0(2)   =  1.0
  K_s0(2)   =  0.1
  C_ps0(2)  =  1000.0
  MW_s(2,1) =  1.0

  C_F = 0.0


!===============================================================================
! Initial Conditions
!===============================================================================
  IC_X_w(1)     =  0.0
  IC_X_e(1)     =  0.03
  IC_Y_s(1)     =  0.0
  IC_Y_n(1)     =  0.03
  IC_EP_g(1)    =  0.628  ! (0.826*0.7+0.05)  ! (1-EP_sc)*EP_g0
  IC_EP_s(1,1)  =  0.198  ! (0.826*0.3-0.05)  ! (1-EP_sc)*EP_s0
  IC_EP_s(1,2)  =  0.174  ! pi*D_cyl^2/(2*a_cyl^2)
  IC_P_g(1)     =  101325.0
  IC_T_g(1)     =  303.0
  IC_T_s(1,1)   =  303.0
  IC_T_s(1,2)   =  303.0
  IC_U_g(1)     =  0.0
  IC_U_s(1,1)   =  0.0
  IC_U_s(1,2)   =  0.0
  IC_V_g(1)     =  0.5
  IC_V_s(1,1)   =  0.5
  IC_V_s(1,2)   =  0.0
  IC_X_g(1,1)   =  1.0
  IC_X_s(1,1,1) =  1.0
  IC_X_s(1,2,1) =  1.0

  IC_X_w(2)     =  0.0    0.015
  IC_X_e(2)     =  0.015  0.03
  IC_Y_s(2)     =  0.0    0.015
  IC_Y_n(2)     =  0.015  0.03

  IC_EP_g(2)    =  2*0.528  ! (0.826*0.7-0.05)
  IC_EP_s(2,1)  =  2*0.298  ! (0.826*0.7+0.05)
  IC_EP_s(2,2)  =  2*0.174
  IC_P_g(2)     =  2*101325.0
  IC_T_g(2)     =  2*303.0
  IC_T_s(2,1)   =  2*303.0
  IC_T_s(2,2)   =  2*303.0
  IC_U_g(2)     =  2*0.0
  IC_U_s(2,1)   =  2*0.0
  IC_U_s(2,2)   =  2*0.0
  IC_V_g(2)     =  2*0.5
  IC_V_s(2,1)   =  2*0.5
  IC_V_s(2,2)   =  2*0.0
  IC_X_g(2,1)   =  2*1.0
  IC_X_s(2,1,1) =  2*1.0
  IC_X_s(2,2,1) =  2*1.0


!===============================================================================
! Boundary Conditions
!===============================================================================
  SG_CYL_HYDRO  = .TRUE.
  SG_CYL_ENERGY = .TRUE.
 
  SG_CYL_D = 0.01
  SG_CYL_a = 0.03
  SG_CYL_T = 293.0

  WRITE_DASHBOARD = .TRUE.
  WRITE_VTK_FILES = .FALSE.


!===============================================================================
! Output Control
!===============================================================================
  RES_DT       =  0.01
  SPX_DT(1)    =  0.1    ! EP_g
  SPX_DT(2)    =  100.0  ! P_g, P*
  SPX_DT(3)    =  0.1    ! U_g, V_g, W_g
  SPX_DT(4)    =  0.1    ! U_s, V_s, W_s
  SPX_DT(5)    =  100.0  ! ROP_s
  SPX_DT(6)    =  0.1    ! T_g, T_s
  SPX_DT(7)    =  100.0  ! X_g, X_s
  SPX_DT(8)    =  100.0  ! Misc
  SPX_DT(9)    =  100.0  ! UDS

  OUT_DT       =  10.0
  NLOG         =  25
  FULL_LOG     = .TRUE.
  GROUP_RESID  = .TRUE.


!===============================================================================
! Parallelization Control
!===============================================================================
  NODESI =  2
  NODESJ =  2
  NODESK =  1
